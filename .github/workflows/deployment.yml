name: Build And Publish to Amazon ECR

on:
  push:
    branches: [main]

permissions:
  contents: write
  packages: write

jobs:
  deploy:
    uses: vti-do2402/cicd-core/.github/workflows/deploy.yml@feat/actions
    with:
      runs_on: ${{ vars.RUNS_ON }}
      environment: ${{ vars.ENVIRONMENT }}
      ecr_repository: ${{ vars.ECR_REPOSITORY }}
      image_tag: ${{ vars.IMAGE_TAG }}
      aws_account_id: ${{ vars.AWS_ACCOUNT_ID }}
      aws_region: ${{ vars.AWS_REGION }}
      github_token: ${{ github.token }}
      default_bump: ${{ vars.VERSION_BUMP_TYPE }}
